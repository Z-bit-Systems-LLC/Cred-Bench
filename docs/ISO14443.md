# ISO 14443 Detection and Credential Parsing

## Overview

ISO 14443 is the base contactless smart card standard. This detector works with any ISO 14443-A or 14443-B compliant card and extracts the UID (Unique Identifier) and CSN (Card Serial Number).

## Detection

### APDU Command

The detector uses the PC/SC pseudo-APDU to retrieve the card's UID:

```
GET UID: FF CA 00 00 00
```

| Byte | Value  | Description          |
|------|--------|----------------------|
| CLA  | `0xFF` | PC/SC pseudo-command |
| INS  | `0xCA` | GET DATA             |
| P1   | `0x00` | UID                  |
| P2   | `0x00` | â€”                    |
| Le   | `0x00` | Max length           |

### Success Response

```
[UID bytes] 90 00
```

The UID is returned as raw bytes followed by status word `90 00` (success).

## Credential Parsing

### UID

The UID (Unique Identifier) is returned in its native byte order from the card. UID lengths vary by card type:

| Length   | Description         | Example             |
|----------|---------------------|---------------------|
| 4 bytes  | Single Size UID     | `A1 B2 C3 D4`      |
| 7 bytes  | Double Size UID     | `04 A1 B2 C3 D4 E5 F6` |
| 10 bytes | Triple Size UID     | 10-byte identifier  |

The first byte of the UID often indicates the manufacturer:

| Byte   | Manufacturer         |
|--------|----------------------|
| `0x04` | NXP                  |
| `0x02` | ST Microelectronics  |
| `0x05` | Infineon             |
| `0x16` | Texas Instruments    |

### CSN (Card Serial Number)

The CSN is derived from the UID by reversing the byte order. For example:

```
UID: 04 A1 B2 C3 D4 E5 F6
CSN: F6E5D4C3B2A104
```

Many physical access control systems use the CSN as the credential identifier.

### Wiegand Representation

The CSN hex is converted to a binary (Wiegand) bit string for compatibility with Wiegand-based access control panels. The bit count matches the UID byte length (e.g., 4-byte UID = 32-bit Wiegand, 7-byte UID = 56-bit Wiegand).

### Display Fields

| Field         | Source           | Description                              |
|---------------|------------------|------------------------------------------|
| Manufacturer  | UID byte 0       | Card IC manufacturer                     |
| UID Length     | UID byte count   | Single/Double/Triple size descriptor     |
| UID            | Raw UID          | Dashed byte format (e.g., `04-A1-B2-C3`) |
| CSN Hex       | Reversed UID     | Hexadecimal, copyable                    |
| Wiegand Bits  | CSN binary       | Binary bit string, copyable              |
